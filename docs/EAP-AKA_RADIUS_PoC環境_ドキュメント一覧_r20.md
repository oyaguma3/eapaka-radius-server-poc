# EAP-AKA RADIUS PoC環境 ドキュメント一覧 (r20)

**作成日:** 2025-12-30
**最終更新:** 2026-02-23
**ステータス:** 開発準備フェーズ

---

## 1. 設計ドキュメント

### 1.1 作成済み

| No. | ドキュメント名 | 版数 | 最終更新 | 内容 |
|-----|---------------|------|---------|------|
| D-01 | ミニPC版 EAP-AKA RADIUS PoC環境 設計仕様書 | r9 | 2026-02-16 | システム概要、アーキテクチャ、ノード構成、パッケージマップ、Vector Gateway追加、Valkeyバージョン9.0統一、Fluent Bit統一、環境変数名統一、実装コードとの不整合20件修正（データモデル注記・Valkeyキースキーマ・パッケージマップ・docker-compose.yml完全同期・healthcheck・テストベクターモード） |
| D-02 | Valkeyデータ設計仕様書 | r10 | 2026-02-18 | データ構造、キー設計、TTL、Go構造体、CK/IK非保存方針、UUID仕様明記、Acct重複検出キャッシュ、stageフィールド値明記、SQN競合制御（WATCH/MULTI CAS）、idx:userクリーンアップ方針 |
| D-03 | Vector-APIインターフェース定義書およびEAP-AKAステートマシン設計書 | r5 | 2026-02-18 | API仕様、8状態定義、Policy評価Post-Authのみ、接続先をVector Gatewayに変更 |
| D-04 | ログ仕様設計書 | r14 | 2026-02-23 | ログフォーマット、event_id定義、Vector Gateway対応、EAP_INVALID_STATE追加、IMSIマスキング（4コンポーネント対応、Admin TUI除外明記）、Acct Server PKT_RECV追加、SQN_CONFLICT_ERR追加 |
| D-05 | Admin TUI詳細設計書【前半】 | r6 | 2026-02-18 | 画面設計、バリデーション、インポート/エクスポート、IMSI表示方針（常に生値）、全マスタデータHash形式統一 |
| D-06 | エラーハンドリング詳細設計書 | r6 | 2026-02-18 | 異常系処理、タイムアウト、リトライ、Circuit Breaker、Vector Gateway追加、SQN競合エラー（409）追加、Vector Gateway経由フロー明記 |
| D-07 | Admin TUI詳細設計書【後半】 | r4 | 2026-02-18 | モニタリング画面、ヘルプダイアログ、IMSI記録方針（監査ログに生値）、idx:userクリーンアップ処理 |
| D-08 | インフラ設定・運用設計書 | r12 | 2026-02-23 | Docker Compose設定、Valkey設定、Fluent Bit設定（fluent/fluent-bit:4.2、YAML形式）、UFW設定、運用手順、IMSIマスキング環境変数（4コンポーネント限定）、Valkeyバージョン9.0、ヘルスチェック方針（curl -fsS）、テストベクターモード環境変数、B-02スコープ修正（B-01境界整合） |
| D-09 | Auth Server詳細設計書 | r9 | 2026-02-18 | パッケージ構成、RADIUS受信処理、EAP制御フロー、Vector Gateway連携、セッション管理、IMSIマスキング、UUID仕様明記、互換性エイリアス削除、ベースイメージ方針 |
| D-10 | Acct Server詳細設計書 | r5 | 2026-02-18 | パッケージ構成、Accounting処理フロー、セッション更新ロジック、重複検出、IMSIマスキング、Status-Server対応、ベースイメージ方針 |
| D-11 | Vector API詳細設計書 | r6 | 2026-02-18 | パッケージ構成、HTTPサーバー設定、Milenage計算、SQN管理、SQN競合制御（WATCH/MULTI CAS）、エラーハンドリング、ベースイメージ方針、テストベクターモード本番無効化注記 |
| D-12 | Vector Gateway詳細設計書 | r4 | 2026-02-18 | 外部API連携設計、PLMNルーティング、接続方式管理、トレーサビリティ、IMSIマスキング、ベースイメージ方針（debian:bookworm-slim） |

### 1.2 未作成

なし（設計ドキュメント全12件完了）

### 1.3 Go実装ノードと設計ドキュメントの対応

| 実装ノード | ディレクトリ | 関連設計ドキュメント |
|-----------|------------|-------------------|
| **Auth Server** | `apps/auth-server` | D-03（ステートマシン）, D-06（エラー処理）, **D-09**（詳細設計） |
| **Acct Server** | `apps/acct-server` | D-02（データ構造）, D-06（エラー処理）, **D-10**（詳細設計） |
| **Vector API** | `apps/vector-api` | D-02（データ構造）, D-03（API仕様）, **D-11**（詳細設計） |
| **Vector Gateway** | `apps/vector-gateway` | **D-12**（詳細設計書） |
| **Admin TUI** | `apps/admin-tui` | D-02（データ構造）, **D-05**（前半）, **D-07**（後半） |

---

## 2. 開発ドキュメント

### 2.1 作成済み

| No. | ドキュメント名 | 版数 | 最終更新 | 内容 |
|-----|---------------|------|---------|------|
| E-01 | 開発環境セットアップガイド | r2 | 2026-01-26 | Go環境構築、Go Workspace設定、依存パッケージ、ローカル開発手順、デバッグ方法、環境変数名統一（RADIUS_SECRET） |
| E-02 | コーディング規約（簡易版） | r1 | 2026-01-25 | 命名規則、パッケージ構成、エラーハンドリングパターン、構造体タグ、ログ出力規約 |
| E-03 | 共通ライブラリ(pkg)設計書 | r2 | 2026-02-18 | pkg配置方針、apperr/valkey/logging/model/httputil各パッケージ設計 |

### 2.2 未作成

なし（開発ドキュメント全3件完了）

---

## 3. テストドキュメント

### 3.1 作成済み

| No. | ドキュメント名 | 版数 | 最終更新 | 内容 |
|-----|---------------|------|---------|------|
| T-01 | テスト戦略書 | r2 | 2026-01-27 | テストレベル定義、テスト範囲、テスト環境、モック戦略、テストデータ戦略、品質ゲート、テストベクターモード運用注記 |
| T-02 | 単体テスト仕様書 | r1 | 2026-02-07 | コンポーネント別テストケース（全876件）、モック戦略、テストデータ設計 |
| T-03 | 結合テスト仕様書 | r5 | 2026-02-22 | コンポーネント間連携テスト、シナリオテスト、テストベクターモード検証、Valkeyデータ整合性検証、Secret体系明確化、SQN再同期手順改訂、IMSI 003専用config追加、障害系PASS条件修正、identityオーバーライドIMSIのSQNリセット運用補足、Dockerイメージ再ビルド注意事項追加 |
| T-04 | E2Eテスト仕様書 | r3 | 2026-02-16 | 実機テスト（SIM/AP）3件、擬似E2E（eapaka_test）5件、実機異常系3件の計11シナリオ、SQN管理注意事項追加、Valkey再起動後データ残存確認追加 |

### 3.2 未作成

なし（テストドキュメント全4件完了）

---

## 4. 構築・デプロイドキュメント

### 4.1 作成済み

| No. | ドキュメント名 | 版数 | 最終更新 | 内容 |
|-----|---------------|------|---------|------|
| B-01 | ホストOS構築手順書 | r2 | 2026-02-16 | Ubuntu Serverインストール、初期設定、セキュリティ設定、Docker導入、systemdサービス登録 |
| B-02 | アプリケーションデプロイ手順書 | r4 | 2026-02-23 | リポジトリクローン、.env作成、Docker Compose起動、Admin TUI配置、logrotate設定、バックアップスクリプト配置、lnavフォーマット配置 |

### 4.2 未作成

なし（構築・デプロイドキュメント全2件完了）

---

## 5. 運用ドキュメント

実装完了後に作成予定。この段階では必須前提・方針と概要を定義し、他ドキュメント作成の指針とする。

### 5.1 運用ガイド類

| No. | ドキュメント名 | 作成時期 | 必須前提・方針 | 概要 |
|-----|---------------|---------|---------------|------|
| O-01 | 操作ガイド（user-guide.md） | 実装完了後 | D-05, D-07の完成後 | 加入者登録、ポリシー設定、セッション監視の操作手順。スクリーンショット付き。 |
| O-02 | ポリシー設定ガイド（policy-config-guide.md） | 実装完了後 | D-02の認可ポリシー設計確定後 | NAS-ID/SSID設定例、VLAN割り当て例、トラブルシューティング |
| O-03 | 障害対応手順書 | 実装完了後 | D-06, D-08の完成後 | 障害検知方法、切り分け手順、復旧手順、エスカレーションフロー |

### 5.2 保守ドキュメント類

| No. | ドキュメント名 | 作成時期 | 必須前提・方針 | 概要 |
|-----|---------------|---------|---------------|------|
| O-04 | バックアップ・リストア手順書 | 実装完了後 | D-08でバックアップ方針定義後 | Valkeyデータのバックアップ/リストア、設定ファイルのバックアップ |
| O-05 | ログ解析ガイド | **完了 (r3)** | D-04の完成後 | lnavの使い方、頻出クエリ集、障害調査パターン |

### 5.3 対外説明資料

| No. | ドキュメント名 | 作成時期 | 必須前提・方針 | 概要 |
|-----|---------------|---------|---------------|------|
| O-06 | 顧客説明ガイドライン資料 | 実装完了後 | 全設計ドキュメント完成後、E2Eテスト完了後 | アウトバウンド営業・ビジネス開発部門向け。本PoCの技術概要、デモシナリオ、想定Q&A、機密情報の取り扱い指針 |

---

## 6. ドキュメント依存関係図

```
[設計ドキュメント] ─────────────────────────────────────────────────────┐
    │                                                                   │
    ├─ D-01: ミニPC版設計仕様書 (r9) ✓                                  │
    ├─ D-02: Valkeyデータ設計仕様書 (r10) ✓                              │
    ├─ D-03: Vector-API/ステートマシン設計書 (r5) ✓                     │
    ├─ D-04: ログ仕様設計書 (r14) ✓                                     │
    ├─ D-05: Admin TUI詳細設計書【前半】(r6) ✓                          │
    ├─ D-06: エラーハンドリング詳細設計書 (r6) ✓                        │
    ├─ D-07: Admin TUI詳細設計書【後半】(r4) ✓                          │
    ├─ D-08: インフラ設定・運用設計書 (r12) ✓                            │
    ├─ D-09: Auth Server詳細設計書 (r9) ✓                               │
    ├─ D-10: Acct Server詳細設計書 (r5) ✓                               │
    ├─ D-11: Vector API詳細設計書 (r6) ✓                                │
    └─ D-12: Vector Gateway詳細設計書 (r4) ✓                            │
                    │                                                   │
                    ▼                                                   │
[開発ドキュメント] ─────────────────────────────────────────────────────┤
    │                                                                   │
    ├─ E-01: 開発環境セットアップガイド (r2) ✓                          │
    ├─ E-02: コーディング規約・簡易版 (r1) ✓                            │
    └─ E-03: 共通ライブラリ設計書 (r2) ✓                                │
                    │                                                   │
                    ▼                                                   │
[テストドキュメント] ───────────────────────────────────────────────────┤
    │                                                                   │
    ├─ T-01: テスト戦略書 (r2) ✓                                        │
    ├─ T-02: 単体テスト仕様書 (r1) ✓                                     │
    ├─ T-03: 結合テスト仕様書 (r5) ✓                                    │
    └─ T-04: E2Eテスト仕様書 (r3) ✓                                    │
                    │                                                   │
                    ▼                                                   │
[構築・デプロイドキュメント] ───────────────────────────────────────────┤
    │                                                                   │
    ├─ B-01: ホストOS構築手順書 (r2) ✓                                   │
    └─ B-02: アプリケーションデプロイ手順書 (r4) ✓                        │
                    │                                                   │
                    ▼                                                   │
[運用ドキュメント] ◄────────────────────────────────────────────────────┘
    │
    ├─ O-01: 操作ガイド (実装完了後)
    ├─ O-02: ポリシー設定ガイド (実装完了後)
    ├─ O-03: 障害対応手順書 (実装完了後)
    ├─ O-04: バックアップ・リストア手順書 (実装完了後)
    ├─ O-05: ログ解析ガイド (実装完了後)
    └─ O-06: 顧客説明ガイドライン資料 (実装完了後)
```

---

## 7. 推奨作成順序

### フェーズ1: 設計完了

| 順序 | ドキュメントID | ドキュメント名 | ステータス |
|-----|---------------|---------------|-----------|
| 1 | D-07 | Admin TUI詳細設計書【後半】 | **完了 (r1)** |
| 2 | D-12 | Vector Gateway詳細設計書 | **完了 (r2)** |
| 3 | D-08 | インフラ設定・運用設計書 | **完了 (r3)** |
| 4 | D-09 | Auth Server詳細設計書 | **完了 (r4)** |
| 5 | D-11 | Vector API詳細設計書 | **完了 (r2)** |
| 6 | D-10 | Acct Server詳細設計書 | **完了 (r1)** |

### フェーズ2: 開発準備

| 順序 | ドキュメントID | ドキュメント名 | ステータス |
|-----|---------------|---------------|-----------|
| 7 | E-01 | 開発環境セットアップガイド | **完了 (r2)** |
| 8 | E-02 | コーディング規約（簡易版） | **完了 (r1)** |
| 9 | E-03 | 共通ライブラリ(pkg)設計書 | **完了 (r1)** |
| 10 | T-01 | テスト戦略書 | **完了 (r2)** |

### フェーズ3: 開発・テスト

| 順序 | ドキュメントID | ドキュメント名 | ステータス |
|-----|---------------|---------------|-----------|
| 11 | T-02 | 単体テスト仕様書 | **完了 (r1)** |
| 12 | T-03 | 結合テスト仕様書 | **完了 (r5)** |
| 13 | T-04 | E2Eテスト仕様書 | **完了 (r3)** |

### フェーズ4: 構築・デプロイ

| 順序 | ドキュメントID | ドキュメント名 | ステータス |
|-----|---------------|---------------|-----------|
| 14 | B-01 | ホストOS構築手順書 | **完了 (r2)** |
| 15 | B-02 | アプリケーションデプロイ手順書 | **完了 (r4)** |

### フェーズ5: 運用準備（実装完了後）

| 順序 | ドキュメントID | ドキュメント名 | ステータス |
|-----|---------------|---------------|-----------|
| 16 | O-01 | 操作ガイド | 未着手 |
| 17 | O-02 | ポリシー設定ガイド | 未着手 |
| 18 | O-03 | 障害対応手順書 | 未着手 |
| 19 | O-04 | バックアップ・リストア手順書 | 未着手 |
| 20 | O-05 | ログ解析ガイド | **完了 (r3)** |
| 21 | O-06 | 顧客説明ガイドライン資料 | 未着手 |

---

## 8. 進捗サマリ

| カテゴリ | 総数 | 作成済み | 未作成 | 進捗率 |
|---------|------|---------|-------|-------|
| 設計ドキュメント | 12 | 12 | 0 | 100% |
| 開発ドキュメント | 3 | 3 | 0 | 100% |
| テストドキュメント | 4 | 4 | 0 | 100% |
| 構築・デプロイドキュメント | 2 | 2 | 0 | 100% |
| 運用ドキュメント | 6 | 1 | 5 | 17% |
| **合計** | **27** | **22** | **5** | **81%** |

---


## 改訂履歴

| 版数 | 日付 | 内容 |
|------|------|------|
| r1 | 2025-12-30 | 初版作成。設計ドキュメント6件作成済み、全23件のドキュメント体系を定義。 |
| r2 | 2026-01-04 | D-07完了反映。Go実装ノード別詳細設計書（D-09〜D-11）を追加。総ドキュメント数23→26件。進捗率26%→27%。 |
| r2 | 2026-01-05 | D-12（Vector Gateway実装レベル検討書）追加。Vector Gatewayのノードマッピング追加。総ドキュメント数26→27件。進捗率27%→30%。 |
| r3 | 2026-01-14 | 各設計ドキュメントの版数更新反映: D-01(r4), D-02(r4), D-03(r3), D-04(r5), D-06(r3)。D-08（インフラ設定・運用設計書）、D-09（Auth Server詳細設計書）作成完了反映。設計ドキュメント進捗率67%→83%。全体進捗率30%→37%。 |
| r4 | 2026-01-18 | IMSIマスキング機能追加に伴う整合性更新: D-04(r6→r7), D-08(r1→r2), D-09(r2→r3), D-12(r1→r2/名称変更)。D-11(r2)を未作成→作成済みに移動。設計ドキュメント進捗率83%→92%、全体進捗率37%→41%。 |
| r5 | 2026-01-20 | 設計フェーズ完了: D-10(r1)作成完了、設計ドキュメント進捗率92%→100%。各ドキュメント版数更新: D-01(r4→r5), D-02(r4→r6), D-04(r7→r8), D-08(r2→r3), D-09(r3→r4)。D-10想定目次セクション削除。全体進捗率41%→44%。 |
| r6 | 2026-01-21 | 各ドキュメント版数更新: D-07(r1→r2), D-10(r1→r2)。D-10 Status-Server対応追加。|
| r7 | 2026-01-25 | 開発ドキュメント完了: E-01(r1), E-02(r1), E-03(r1)作成完了。開発ドキュメント進捗率0%→100%、全体進捗率44%→56%。各設計ドキュメント版数更新: D-02(r6→r7), D-04(r8→r9), D-08(r3→r4), D-09(r4→r5)。ステータスを「開発準備フェーズ」に変更。 |
| r8 | 2026-01-27 | レビューコメント対応（Phase 1-5）完了反映: T-01(r2)作成完了、テストドキュメント進捗率0%→25%、全体進捗率56%→59%。各ドキュメント版数更新: D-01(r5→r6), D-02(r7→r9), D-03(r3→r4), D-04(r9→r11), D-05(r2→r3), D-06(r3→r5), D-07(r2→r3), D-08(r4→r7), D-09(r5→r7), D-10(r2→r3), D-11(r2→r5), D-12(r2→r3), E-01(r1→r2)。主な更新内容: SQN競合制御、インフラ基盤統一、API接続設計統一、IMSIマスキング適用範囲明確化、idx:userクリーンアップ、テストベクターモード運用注記。 |
| r9 | 2026-01-27 | レビュー指摘対応（Phase 6）: D-09/D-10のDockerfileにprocps追加（ヘルスチェック整合性）、D-08にpgrep依存パッケージ明記、D-04にIDX_USER_CLEANUP event_id追加、D-01のdocker-compose.yml buildパス修正。各ドキュメント版数更新: D-01(r6→r7), D-04(r11→r12), D-08(r7→r8), D-09(r7→r8), D-10(r3→r4)。 |
| r10 | 2026-01-27 | D-01のFluent Bit設定ファイル相対パス修正に伴う版数更新（D-01 r8）。依存関係図の版数反映。 |
| r11 | 2026-02-07 | D-05版数更新（r3→r5）：全マスタデータHash形式統一。T-03結合テスト仕様書（r1）作成完了、テストドキュメント進捗率25%→50%、全体進捗率59%→63%。 |
| r12 | 2026-02-07 | テストドキュメント完了: T-02単体テスト仕様書（r1）作成完了（全876テストケース）、T-04 E2Eテスト仕様書（r2）作成完了（実機3件+擬似E2E 5件+実機異常系3件=計11シナリオ）。テストドキュメント進捗率50%→100%、全体進捗率63%→70%。 |
| r13 | 2026-02-07 | 構築・デプロイドキュメント完了: B-01ホストOS構築手順書（r1）、B-02アプリケーションデプロイ手順書（r1）作成完了。D-08版数更新（r8→r9、B-02スコープ修正）。構築・デプロイドキュメント進捗率0%→100%、全体進捗率70%→78%。 |
| r14 | 2026-02-16 | D-01版数更新（r8→r9）: 実装コードとの不整合20件修正（データモデル注記追加、パッケージマップ更新、Valkeyキースキーマ概要追加、docker-compose.yml完全同期、healthcheck・テストベクターモード・healthエンドポイント記載追加）。B-01版数更新（r1→r2）、B-02版数更新（r1→r2）: 関連ドキュメント参照版数をD-01 r9に整合。 |
| r15 | 2026-02-16 | テスト仕様書ファイル名に版数付与: T-02（r1）、T-03（r1→r3）、T-04（r2→r3）。T-03: Secret体系明確化、SQN再同期手順改訂、IMSI 003専用config追加、障害系PASS条件修正。T-04: SQN管理注意事項追加、Valkey再起動後データ残存確認追加。 |
| r16 | 2026-02-18 | 全文書版数を最新に更新 |
| r17 | 2026-02-22 | O-05ログ解析ガイド（r1）作成完了。運用ドキュメント進捗率0%→17%、全体進捗率78%→81%。 |
| r18 | 2026-02-22 | T-03結合テスト仕様書 版数更新（r3→r5）: go-eapaka PRF修正後の再テストで得られた知見を反映（identityオーバーライドIMSIのSQNリセット運用補足、Dockerイメージ再ビルド注意事項追加）。 |
| r19 | 2026-02-23 | lnavフォーマット・Fluent Bit設定修正に伴う版数更新: D-04(r13→r14)、D-08(r10→r11)、B-02(r2→r4)、O-05(r1→r2)。lnavプロパティ名をハイフン区切りに修正、Fluent Bitログルーティング修正（rewrite_tag廃止→parserフィルター＋タグベースルーティング）。 |
| r20 | 2026-02-23 | Fluent Bit 3.0→4.2アップグレード＋YAML移行に伴う版数更新: D-08(r11→r12)、O-05(r2→r3)。Classic config廃止に伴いYAML形式に移行、Distrolessベースイメージ対応、lnavフォーマットapp値定義追加。 |
