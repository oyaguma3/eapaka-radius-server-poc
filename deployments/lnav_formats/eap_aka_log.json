{
    "$schema": "https://lnav.org/schemas/format-v1.schema.json",
    "aka_radius_log": {
        "title": "EAP-AKA RADIUS System Logs",
        "description": "Structured JSON logs from Go RADIUS PoC (slog JSONHandler)",
        "url": "http://localhost",
        "json": true,
        "file-pattern": "(?:auth-server|acct-server|vector-api|vector-gateway)\\.log",
        "timestamp-field": "time",
        "level-field": "level",
        "body-field": "msg",
        "value": {
            "app": { "kind": "string", "identifier": true },
            "imsi": { "kind": "string", "identifier": true },
            "trace_id": { "kind": "string", "identifier": true },
            "event_id": { "kind": "string", "identifier": true },
            "backend_id": { "kind": "string", "identifier": true },
            "plmn": { "kind": "string", "identifier": true },
            "latency_ms": { "kind": "integer" },
            "input_octets": { "kind": "integer" },
            "output_octets": { "kind": "integer" },
            "retry_count": { "kind": "integer" },
            "downtime_ms": { "kind": "integer" },
            "failure_count": { "kind": "integer" },
            "resync_count": { "kind": "integer" },
            "http_status": { "kind": "integer" }
        },
        "sample": [
            {
                "line": "{\"time\":\"2026-02-28T23:00:02.356730959+09:00\",\"level\":\"INFO\",\"msg\":\"starting vector-api\",\"app\":\"vector-api\",\"listen_addr\":\":8080\",\"log_level\":\"INFO\",\"test_mode\":false}"
            },
            {
                "line": "{\"time\":\"2026-02-28T23:00:07.393000000+09:00\",\"level\":\"INFO\",\"msg\":\"request completed\",\"app\":\"vector-api\",\"trace_id\":\"no-trace-id\",\"method\":\"GET\",\"path\":\"/health\",\"http_status\":200,\"latency_ms\":0}"
            },
            {
                "line": "{\"time\":\"2026-02-28T23:00:08.845000000+09:00\",\"level\":\"ERROR\",\"msg\":\"authentication failed\",\"app\":\"auth-server\",\"imsi\":\"440101********0\",\"trace_id\":\"abc-123\",\"event_id\":\"AUTH_FAIL\"}",
                "level": "error"
            }
        ],
        "line-format": [
            { "field": "time" }, " ",
            { "field": "level" }, " ",
            { "field": "app" }, " ",
            { "field": "event_id", "default-value": "-" }, " ",
            "[", { "field": "imsi", "default-value": "no-imsi" }, "] ",
            { "field": "msg" }
        ]
    }
}
